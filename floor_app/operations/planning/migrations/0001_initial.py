# Generated by Django 5.2.6 on 2025-11-17 16:12

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='KPIDefinition',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('code', models.CharField(db_index=True, help_text='KPI code (e.g., OTD, TAT, REWORK_RATE)', max_length=50, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField()),
                ('category', models.CharField(choices=[('DELIVERY', 'Delivery Performance'), ('QUALITY', 'Quality Metrics'), ('EFFICIENCY', 'Efficiency/Utilization'), ('COST', 'Cost Metrics'), ('SAFETY', 'Safety Metrics'), ('PRODUCTIVITY', 'Productivity Metrics')], max_length=50)),
                ('unit', models.CharField(help_text='Unit of measurement (%, hours, count, SAR)', max_length=50)),
                ('calculation_method', models.TextField(help_text='How to calculate this KPI')),
                ('target_value', models.DecimalField(blank=True, decimal_places=4, help_text='Target value to achieve', max_digits=12, null=True)),
                ('warning_threshold', models.DecimalField(blank=True, decimal_places=4, help_text='Value that triggers warning', max_digits=12, null=True)),
                ('critical_threshold', models.DecimalField(blank=True, decimal_places=4, help_text='Value that triggers critical alert', max_digits=12, null=True)),
                ('higher_is_better', models.BooleanField(default=True, help_text='Is a higher value better (True) or lower (False)?')),
                ('aggregation_period', models.CharField(choices=[('DAILY', 'Daily'), ('WEEKLY', 'Weekly'), ('MONTHLY', 'Monthly'), ('QUARTERLY', 'Quarterly'), ('YEARLY', 'Yearly')], default='MONTHLY', max_length=20)),
                ('is_active', models.BooleanField(default=True)),
                ('display_order', models.PositiveIntegerField(default=0)),
                ('show_on_dashboard', models.BooleanField(default=True)),
                ('decimal_places', models.PositiveIntegerField(default=2)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'KPI Definition',
                'verbose_name_plural': 'KPI Definitions',
                'db_table': 'planning_kpi_definition',
                'ordering': ['category', 'display_order', 'code'],
            },
        ),
        migrations.CreateModel(
            name='KPIValue',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('period_start', models.DateField(db_index=True)),
                ('period_end', models.DateField(db_index=True)),
                ('value', models.DecimalField(decimal_places=4, max_digits=12)),
                ('job_card_id', models.BigIntegerField(blank=True, help_text='Reference to production.JobCard (for job-level KPIs)', null=True)),
                ('batch_order_id', models.BigIntegerField(blank=True, help_text='Reference to production.BatchOrder', null=True)),
                ('customer_name', models.CharField(blank=True, default='', help_text='Customer for customer-specific KPIs', max_length=100)),
                ('employee_id', models.BigIntegerField(blank=True, help_text='Reference to hr.HREmployee (for employee performance)', null=True)),
                ('asset_id', models.BigIntegerField(blank=True, help_text='Reference to maintenance.Asset (for equipment KPIs)', null=True)),
                ('department', models.CharField(blank=True, default='', help_text='Department for department-level KPIs', max_length=50)),
                ('is_on_target', models.BooleanField(default=True)),
                ('variance_from_target', models.DecimalField(blank=True, decimal_places=4, max_digits=12, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('kpi_definition', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='values', to='planning.kpidefinition')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'KPI Value',
                'verbose_name_plural': 'KPI Values',
                'db_table': 'planning_kpi_value',
                'ordering': ['kpi_definition', '-period_start'],
            },
        ),
        migrations.CreateModel(
            name='ProductionSchedule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('schedule_date', models.DateField(help_text='Schedule effective date')),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('PUBLISHED', 'Published'), ('FROZEN', 'Frozen - No Changes'), ('SUPERSEDED', 'Superseded by New Schedule')], db_index=True, default='DRAFT', max_length=20)),
                ('planning_horizon_days', models.PositiveIntegerField(default=30, help_text='Number of days this schedule covers')),
                ('scheduling_algorithm', models.CharField(choices=[('EARLIEST_DUE_DATE', 'Earliest Due Date First'), ('SHORTEST_JOB_FIRST', 'Shortest Job First'), ('CRITICAL_RATIO', 'Critical Ratio'), ('PRIORITY_WEIGHTED', 'Priority Weighted'), ('MANUAL', 'Manual Scheduling')], default='EARLIEST_DUE_DATE', max_length=50)),
                ('priority_weighting', models.JSONField(default=dict, help_text="Priority weights (e.g., {'CRITICAL': 1.0, 'RUSH': 0.8})")),
                ('published_at', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='schedules_created', to=settings.AUTH_USER_MODEL)),
                ('published_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='schedules_published', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Production Schedule',
                'verbose_name_plural': 'Production Schedules',
                'db_table': 'planning_production_schedule',
                'ordering': ['-schedule_date', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ResourceType',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('code', models.CharField(db_index=True, help_text='Resource type code (e.g., CNC-GRINDING, BRAZING-STATION)', max_length=50, unique=True)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True, default='')),
                ('category', models.CharField(choices=[('MACHINE', 'Machine/Equipment'), ('STATION', 'Work Station'), ('SKILL', 'Skill/Competency'), ('TOOL', 'Tooling'), ('AREA', 'Production Area')], max_length=50)),
                ('department', models.CharField(blank=True, default='', help_text='Department this resource belongs to', max_length=50)),
                ('default_capacity_per_shift', models.DecimalField(decimal_places=2, default=8.0, help_text='Default available hours per shift', max_digits=8)),
                ('efficiency_factor', models.DecimalField(decimal_places=2, default=0.85, help_text='Expected efficiency (0-1, e.g., 0.85 = 85%)', max_digits=5)),
                ('is_bottleneck', models.BooleanField(default=False, help_text='Known bottleneck resource - needs close monitoring')),
                ('is_active', models.BooleanField(default=True)),
                ('setup_time_minutes', models.PositiveIntegerField(default=0, help_text='Average setup/changeover time in minutes')),
                ('min_batch_size', models.PositiveIntegerField(default=1, help_text='Minimum batch size for efficiency')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Resource Type',
                'verbose_name_plural': 'Resource Types',
                'db_table': 'planning_resource_type',
                'ordering': ['category', 'code'],
            },
        ),
        migrations.CreateModel(
            name='ResourceCapacity',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('date', models.DateField(db_index=True)),
                ('shift', models.CharField(choices=[('DAY', 'Day Shift'), ('NIGHT', 'Night Shift'), ('ALL', 'All Day')], default='ALL', max_length=20)),
                ('available_hours', models.DecimalField(decimal_places=2, help_text='Total available hours for this resource on this date', max_digits=8)),
                ('reserved_hours', models.DecimalField(decimal_places=2, default=0, help_text='Hours reserved for maintenance, training, etc.', max_digits=8)),
                ('planned_load_hours', models.DecimalField(decimal_places=2, default=0, help_text='Total planned work hours', max_digits=8)),
                ('actual_load_hours', models.DecimalField(decimal_places=2, default=0, help_text='Actual hours used (updated from shop floor)', max_digits=8)),
                ('notes', models.TextField(blank=True, default='')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('resource_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='capacity_records', to='planning.resourcetype')),
            ],
            options={
                'verbose_name': 'Resource Capacity',
                'verbose_name_plural': 'Resource Capacities',
                'db_table': 'planning_resource_capacity',
                'ordering': ['date', 'resource_type'],
            },
        ),
        migrations.CreateModel(
            name='ScheduledOperation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('job_card_id', models.BigIntegerField(db_index=True, help_text='Reference to production.JobCard')),
                ('job_route_step_id', models.BigIntegerField(blank=True, help_text='Reference to production.JobRouteStep', null=True)),
                ('operation_code', models.CharField(help_text='Operation code from OperationDefinition', max_length=50)),
                ('planned_start', models.DateTimeField()),
                ('planned_end', models.DateTimeField()),
                ('planned_duration_hours', models.DecimalField(decimal_places=2, max_digits=8)),
                ('assigned_asset_id', models.BigIntegerField(blank=True, help_text='Reference to maintenance.Asset', null=True)),
                ('assigned_employee_id', models.BigIntegerField(blank=True, help_text='Reference to hr.HREmployee', null=True)),
                ('sequence_number', models.PositiveIntegerField(default=0)),
                ('priority_score', models.DecimalField(decimal_places=4, default=0, help_text='Calculated priority score for scheduling', max_digits=10)),
                ('earliest_start', models.DateTimeField(blank=True, help_text='Cannot start before this time (predecessor constraint)', null=True)),
                ('latest_end', models.DateTimeField(blank=True, help_text='Must finish by this time (customer due date)', null=True)),
                ('status', models.CharField(choices=[('PLANNED', 'Planned'), ('RELEASED', 'Released to Shop Floor'), ('IN_PROGRESS', 'In Progress'), ('WAITING', 'Waiting'), ('COMPLETED', 'Completed'), ('CANCELLED', 'Cancelled')], db_index=True, default='PLANNED', max_length=20)),
                ('actual_start', models.DateTimeField(blank=True, null=True)),
                ('actual_end', models.DateTimeField(blank=True, null=True)),
                ('actual_duration_hours', models.DecimalField(blank=True, decimal_places=2, max_digits=8, null=True)),
                ('is_delayed', models.BooleanField(default=False)),
                ('delay_reason', models.CharField(blank=True, default='', max_length=200)),
                ('delay_category', models.CharField(blank=True, choices=[('MATERIAL', 'Material Shortage'), ('EQUIPMENT', 'Equipment Issue'), ('QUALITY', 'Quality Hold'), ('LABOR', 'Labor Shortage'), ('EXTERNAL', 'External Dependency'), ('OTHER', 'Other')], default='', max_length=50)),
                ('materials_available', models.BooleanField(default=True)),
                ('materials_shortage_list', models.TextField(blank=True, default='', help_text='JSON list of missing items')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('resource_type', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='scheduled_operations', to='planning.resourcetype')),
                ('schedule', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='scheduled_operations', to='planning.productionschedule')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Scheduled Operation',
                'verbose_name_plural': 'Scheduled Operations',
                'db_table': 'planning_scheduled_operation',
                'ordering': ['schedule', 'planned_start', 'sequence_number'],
            },
        ),
        migrations.CreateModel(
            name='WIPSnapshot',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('snapshot_time', models.DateTimeField(db_index=True)),
                ('total_jobs_in_wip', models.PositiveIntegerField(default=0)),
                ('jobs_on_track', models.PositiveIntegerField(default=0)),
                ('jobs_at_risk', models.PositiveIntegerField(default=0)),
                ('jobs_delayed', models.PositiveIntegerField(default=0)),
                ('jobs_in_evaluation', models.PositiveIntegerField(default=0)),
                ('jobs_awaiting_approval', models.PositiveIntegerField(default=0)),
                ('jobs_awaiting_materials', models.PositiveIntegerField(default=0)),
                ('jobs_in_production', models.PositiveIntegerField(default=0)),
                ('jobs_under_qc', models.PositiveIntegerField(default=0)),
                ('jobs_on_hold', models.PositiveIntegerField(default=0)),
                ('bottleneck_resources_json', models.JSONField(default=list, help_text='List of overloaded resources with utilization data')),
                ('total_wip_value', models.DecimalField(decimal_places=2, default=0, help_text='Total value of jobs currently in WIP', max_digits=15)),
                ('avg_age_days', models.DecimalField(decimal_places=2, default=0, help_text='Average age of jobs in WIP', max_digits=8)),
                ('max_age_days', models.PositiveIntegerField(default=0, help_text='Age of oldest job in WIP')),
                ('notes', models.TextField(blank=True, default='')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'WIP Snapshot',
                'verbose_name_plural': 'WIP Snapshots',
                'db_table': 'planning_wip_snapshot',
                'ordering': ['-snapshot_time'],
            },
        ),
        migrations.CreateModel(
            name='DeliveryForecast',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('job_card_id', models.BigIntegerField(db_index=True, help_text='Reference to production.JobCard')),
                ('batch_order_id', models.BigIntegerField(blank=True, help_text='Reference to production.BatchOrder', null=True)),
                ('customer_required_date', models.DateField(help_text='Date customer expects delivery')),
                ('forecast_date', models.DateField(help_text='Predicted completion date based on current progress')),
                ('confidence_level', models.CharField(choices=[('HIGH', 'High - 90%+ probability'), ('MEDIUM', 'Medium - 70-90% probability'), ('LOW', 'Low - <70% probability')], max_length=20)),
                ('risk_factors_json', models.JSONField(default=list, help_text='List of identified risk factors')),
                ('potential_delay_days', models.IntegerField(default=0, help_text='Estimated delay from customer required date')),
                ('at_risk', models.BooleanField(default=False)),
                ('actions_required', models.TextField(blank=True, default='', help_text='Recommended actions to mitigate risk')),
                ('escalation_required', models.BooleanField(default=False)),
                ('escalation_reason', models.TextField(blank=True, default='')),
                ('calculated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Delivery Forecast',
                'verbose_name_plural': 'Delivery Forecasts',
                'db_table': 'planning_delivery_forecast',
                'ordering': ['-calculated_at'],
                'indexes': [models.Index(fields=['job_card_id'], name='ix_plan_delfor_job'), models.Index(fields=['at_risk'], name='ix_plan_delfor_risk'), models.Index(fields=['forecast_date'], name='ix_plan_delfor_forecast'), models.Index(fields=['customer_required_date'], name='ix_plan_delfor_custdate')],
            },
        ),
        migrations.CreateModel(
            name='JobMetrics',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('job_card_id', models.BigIntegerField(db_index=True, help_text='Reference to production.JobCard', unique=True)),
                ('total_turnaround_hours', models.DecimalField(blank=True, decimal_places=2, help_text='Total time from job creation to completion', max_digits=10, null=True)),
                ('active_work_hours', models.DecimalField(blank=True, decimal_places=2, help_text='Hours of actual work performed', max_digits=10, null=True)),
                ('waiting_hours', models.DecimalField(blank=True, decimal_places=2, help_text='Hours spent waiting (for materials, approvals, etc.)', max_digits=10, null=True)),
                ('queue_hours', models.DecimalField(blank=True, decimal_places=2, help_text='Hours in queue between operations', max_digits=10, null=True)),
                ('rework_count', models.PositiveIntegerField(default=0, help_text='Number of times job required rework')),
                ('ncr_count', models.PositiveIntegerField(default=0, help_text='Number of NCRs raised for this job')),
                ('defect_rate', models.DecimalField(blank=True, decimal_places=2, help_text='Defect rate as percentage', max_digits=5, null=True)),
                ('first_pass_yield', models.DecimalField(blank=True, decimal_places=2, help_text='First pass yield percentage', max_digits=5, null=True)),
                ('planned_completion', models.DateTimeField(blank=True, help_text='Originally planned completion date', null=True)),
                ('actual_completion', models.DateTimeField(blank=True, null=True)),
                ('is_on_time', models.BooleanField(default=True)),
                ('delay_days', models.IntegerField(default=0, help_text='Positive = late, Negative = early')),
                ('estimated_cost', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('actual_cost', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('cost_variance', models.DecimalField(decimal_places=2, default=0, help_text='Positive = over budget, Negative = under budget', max_digits=12)),
                ('labor_cost', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('material_cost', models.DecimalField(decimal_places=2, default=0, max_digits=12)),
                ('efficiency_rate', models.DecimalField(blank=True, decimal_places=2, help_text='Actual vs standard time efficiency', max_digits=5, null=True)),
                ('utilization_rate', models.DecimalField(blank=True, decimal_places=2, help_text='Resource utilization percentage', max_digits=5, null=True)),
                ('calculated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Job Metrics',
                'verbose_name_plural': 'Job Metrics',
                'db_table': 'planning_job_metrics',
                'ordering': ['-calculated_at'],
                'indexes': [models.Index(fields=['job_card_id'], name='ix_plan_jobmet_job'), models.Index(fields=['is_on_time'], name='ix_plan_jobmet_ontime'), models.Index(fields=['actual_completion'], name='ix_plan_jobmet_complete')],
            },
        ),
        migrations.AddIndex(
            model_name='kpidefinition',
            index=models.Index(fields=['code'], name='ix_plan_kpidef_code'),
        ),
        migrations.AddIndex(
            model_name='kpidefinition',
            index=models.Index(fields=['category'], name='ix_plan_kpidef_cat'),
        ),
        migrations.AddIndex(
            model_name='kpidefinition',
            index=models.Index(fields=['is_active'], name='ix_plan_kpidef_active'),
        ),
        migrations.AddIndex(
            model_name='kpivalue',
            index=models.Index(fields=['kpi_definition', 'period_start'], name='ix_plan_kpival_def_start'),
        ),
        migrations.AddIndex(
            model_name='kpivalue',
            index=models.Index(fields=['customer_name', 'period_start'], name='ix_plan_kpival_cust_start'),
        ),
        migrations.AddIndex(
            model_name='kpivalue',
            index=models.Index(fields=['period_start'], name='ix_plan_kpival_start'),
        ),
        migrations.AddIndex(
            model_name='kpivalue',
            index=models.Index(fields=['is_on_target'], name='ix_plan_kpival_target'),
        ),
        migrations.AddIndex(
            model_name='productionschedule',
            index=models.Index(fields=['schedule_date'], name='ix_plan_sched_date'),
        ),
        migrations.AddIndex(
            model_name='productionschedule',
            index=models.Index(fields=['status'], name='ix_plan_sched_status'),
        ),
        migrations.AddIndex(
            model_name='resourcetype',
            index=models.Index(fields=['code'], name='ix_plan_restype_code'),
        ),
        migrations.AddIndex(
            model_name='resourcetype',
            index=models.Index(fields=['category'], name='ix_plan_restype_cat'),
        ),
        migrations.AddIndex(
            model_name='resourcetype',
            index=models.Index(fields=['is_bottleneck'], name='ix_plan_restype_bottleneck'),
        ),
        migrations.AddIndex(
            model_name='resourcetype',
            index=models.Index(fields=['is_active'], name='ix_plan_restype_active'),
        ),
        migrations.AddIndex(
            model_name='resourcecapacity',
            index=models.Index(fields=['resource_type', 'date'], name='ix_plan_rescap_type_date'),
        ),
        migrations.AddIndex(
            model_name='resourcecapacity',
            index=models.Index(fields=['date'], name='ix_plan_rescap_date'),
        ),
        migrations.AlterUniqueTogether(
            name='resourcecapacity',
            unique_together={('resource_type', 'date', 'shift')},
        ),
        migrations.AddIndex(
            model_name='scheduledoperation',
            index=models.Index(fields=['schedule'], name='ix_plan_schedop_sched'),
        ),
        migrations.AddIndex(
            model_name='scheduledoperation',
            index=models.Index(fields=['job_card_id'], name='ix_plan_schedop_job'),
        ),
        migrations.AddIndex(
            model_name='scheduledoperation',
            index=models.Index(fields=['status'], name='ix_plan_schedop_status'),
        ),
        migrations.AddIndex(
            model_name='scheduledoperation',
            index=models.Index(fields=['planned_start'], name='ix_plan_schedop_start'),
        ),
        migrations.AddIndex(
            model_name='scheduledoperation',
            index=models.Index(fields=['resource_type', 'planned_start'], name='ix_plan_schedop_res_start'),
        ),
        migrations.AddIndex(
            model_name='scheduledoperation',
            index=models.Index(fields=['is_delayed'], name='ix_plan_schedop_delayed'),
        ),
        migrations.AddIndex(
            model_name='wipsnapshot',
            index=models.Index(fields=['snapshot_time'], name='ix_plan_wipsn_time'),
        ),
    ]
