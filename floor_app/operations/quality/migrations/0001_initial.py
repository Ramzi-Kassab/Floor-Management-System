# Generated by Django 5.2.6 on 2025-11-17 16:12

import django.db.models.deletion
import django.utils.timezone
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AcceptanceCriteriaTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('code', models.CharField(db_index=True, help_text='Template code (e.g., ARAMCO-HDBS-GRINDING)', max_length=50, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('description', models.TextField()),
                ('applies_to_bit_type', models.CharField(blank=True, default='', help_text='Bit type code (e.g., HDBS, SMI, PDC)', max_length=20)),
                ('applies_to_customer', models.CharField(blank=True, default='', help_text='Customer name or code (e.g., ARAMCO)', max_length=100)),
                ('applies_to_process', models.CharField(blank=True, default='', help_text='Process name (e.g., GRINDING, BRAZING, THREADING)', max_length=100)),
                ('criteria_json', models.JSONField(default=dict, help_text='Criteria values as JSON (e.g., {"max_wear_flat": 3.0, "min_exposure": 2.5})')),
                ('api_standard', models.CharField(blank=True, default='', help_text='API standard reference (e.g., API RP 7G-2)', max_length=100)),
                ('customer_spec', models.CharField(blank=True, default='', help_text='Customer specification reference', max_length=100)),
                ('internal_spec', models.CharField(blank=True, default='', help_text='Internal specification/procedure reference', max_length=100)),
                ('is_active', models.BooleanField(default=True)),
                ('version', models.CharField(default='1.0', max_length=20)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Acceptance Criteria Template',
                'verbose_name_plural': 'Acceptance Criteria Templates',
                'db_table': 'quality_acceptance_criteria_template',
                'ordering': ['code'],
            },
        ),
        migrations.CreateModel(
            name='CalibratedEquipment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('equipment_id', models.CharField(db_index=True, help_text='Internal equipment ID tag (e.g., CAL-001)', max_length=50, unique=True)),
                ('name', models.CharField(max_length=200)),
                ('equipment_type', models.CharField(choices=[('TORQUE_WRENCH', 'Torque Wrench'), ('THREAD_GAUGE', 'Thread Gauge'), ('BORE_GAUGE', 'Bore Gauge'), ('MICROMETER', 'Micrometer'), ('CALIPER', 'Caliper'), ('DEPTH_GAUGE', 'Depth Gauge'), ('HEIGHT_GAUGE', 'Height Gauge'), ('LPT_KIT', 'LPT Testing Kit'), ('MPI_EQUIPMENT', 'MPI Equipment'), ('HARDNESS_TESTER', 'Hardness Tester'), ('SURFACE_ROUGHNESS', 'Surface Roughness Tester'), ('OPTICAL_COMPARATOR', 'Optical Comparator'), ('CMM', 'Coordinate Measuring Machine'), ('OTHER', 'Other')], max_length=50)),
                ('manufacturer', models.CharField(blank=True, default='', max_length=100)),
                ('model', models.CharField(blank=True, default='', max_length=100)),
                ('serial_number', models.CharField(blank=True, default='', max_length=100)),
                ('calibration_interval_days', models.PositiveIntegerField(default=365, help_text='Days between calibrations')),
                ('calibration_procedure', models.TextField(blank=True, default='', help_text='Reference to calibration procedure document')),
                ('calibration_standard', models.CharField(blank=True, default='', help_text='Standard used for calibration (e.g., ISO 17025)', max_length=100)),
                ('last_calibration_date', models.DateField(blank=True, null=True)),
                ('next_calibration_due', models.DateField(blank=True, db_index=True, null=True)),
                ('last_calibration_result', models.CharField(blank=True, choices=[('PASS', 'Pass - Within Tolerance'), ('ADJUSTED', 'Adjusted - Now Within Tolerance'), ('FAIL', 'Fail - Out of Tolerance'), ('LIMITED', 'Limited Use - Conditional Pass')], default='', max_length=20)),
                ('status', models.CharField(choices=[('IN_SERVICE', 'In Service - Calibration Current'), ('DUE_SOON', 'Due for Calibration Soon'), ('OVERDUE', 'Calibration Overdue - Do Not Use'), ('OUT_OF_SERVICE', 'Out of Service'), ('UNDER_CALIBRATION', 'Under Calibration'), ('QUARANTINE', 'Quarantine - Investigation Needed')], db_index=True, default='IN_SERVICE', max_length=20)),
                ('location', models.CharField(blank=True, default='', help_text='Physical location of equipment', max_length=100)),
                ('custodian', models.CharField(blank=True, default='', help_text='Person responsible for this equipment', max_length=100)),
                ('certificate_number', models.CharField(blank=True, default='', max_length=100)),
                ('calibration_lab', models.CharField(blank=True, default='', help_text='External lab or internal calibration', max_length=200)),
                ('is_critical', models.BooleanField(default=False, help_text='Critical for product quality - requires expedited calibration')),
                ('purchase_date', models.DateField(blank=True, null=True)),
                ('warranty_expiry', models.DateField(blank=True, null=True)),
                ('purchase_cost', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Calibrated Equipment',
                'verbose_name_plural': 'Calibrated Equipment',
                'db_table': 'quality_calibrated_equipment',
                'ordering': ['equipment_id'],
            },
        ),
        migrations.CreateModel(
            name='CalibrationRecord',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('calibration_date', models.DateField()),
                ('performed_by', models.CharField(help_text='Technician or lab who performed calibration', max_length=100)),
                ('calibration_lab', models.CharField(blank=True, default='', max_length=200)),
                ('certificate_number', models.CharField(max_length=100)),
                ('result', models.CharField(choices=[('PASS', 'Pass - Within Tolerance'), ('ADJUSTED', 'Adjusted - Now Within Tolerance'), ('FAIL', 'Fail - Out of Tolerance'), ('LIMITED', 'Limited Use - Conditional Pass')], max_length=20)),
                ('adjustments_made', models.TextField(blank=True, default='', help_text='Description of any adjustments made')),
                ('out_of_tolerance_findings', models.TextField(blank=True, default='', help_text='Details of out-of-tolerance conditions found')),
                ('measurements_json', models.JSONField(default=dict, help_text='Actual measurement data from calibration')),
                ('next_due_date', models.DateField()),
                ('cost', models.DecimalField(decimal_places=2, default=0, max_digits=10)),
                ('certificate_file', models.FileField(blank=True, null=True, upload_to='quality/calibration/')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('equipment', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='calibration_records', to='quality.calibratedequipment')),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Calibration Record',
                'verbose_name_plural': 'Calibration Records',
                'db_table': 'quality_calibration_record',
                'ordering': ['equipment', '-calibration_date'],
            },
        ),
        migrations.CreateModel(
            name='DefectCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('code', models.CharField(db_index=True, help_text='Short code (e.g., VISUAL, DIMENSIONAL, MATERIAL)', max_length=20, unique=True)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True, default='')),
                ('is_critical', models.BooleanField(default=False, help_text='Critical defects trigger immediate containment')),
                ('sort_order', models.PositiveIntegerField(default=0)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Defect Category',
                'verbose_name_plural': 'Defect Categories',
                'db_table': 'quality_defect_category',
                'ordering': ['sort_order', 'code'],
            },
        ),
        migrations.CreateModel(
            name='NonconformanceReport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('ncr_number', models.CharField(db_index=True, help_text='Auto-generated NCR number (e.g., NCR-2025-0001)', max_length=50, unique=True)),
                ('ncr_type', models.CharField(choices=[('INTERNAL', 'Internal NC'), ('SUPPLIER', 'Supplier NC'), ('CUSTOMER', 'Customer Complaint'), ('PROCESS', 'Process Deviation')], max_length=20)),
                ('status', models.CharField(choices=[('OPEN', 'Open - Under Investigation'), ('CONTAINED', 'Contained - Immediate Action Taken'), ('ROOT_CAUSE', 'Root Cause Analysis'), ('CORRECTIVE', 'Corrective Action In Progress'), ('VERIFICATION', 'Verification Pending'), ('CLOSED', 'Closed'), ('CANCELLED', 'Cancelled')], db_index=True, default='OPEN', max_length=20)),
                ('job_card_id', models.BigIntegerField(blank=True, db_index=True, help_text='Reference to production.JobCard', null=True)),
                ('serial_unit_id', models.BigIntegerField(blank=True, help_text='Reference to inventory.SerialUnit', null=True)),
                ('batch_order_id', models.BigIntegerField(blank=True, help_text='Reference to production.BatchOrder', null=True)),
                ('title', models.CharField(max_length=200)),
                ('description', models.TextField()),
                ('detection_point', models.CharField(help_text='Where the issue was discovered (e.g., Incoming QC, Final Inspection)', max_length=100)),
                ('detection_method', models.CharField(help_text='How the issue was discovered (e.g., Visual, Dimensional, NDT)', max_length=100)),
                ('quantity_affected', models.PositiveIntegerField(default=1)),
                ('quantity_contained', models.PositiveIntegerField(default=0)),
                ('severity', models.CharField(choices=[('CRITICAL', 'Critical - Safety/Major Customer Impact'), ('MAJOR', 'Major - Significant Quality Issue'), ('MINOR', 'Minor - Cosmetic/Documentation Issue')], max_length=20)),
                ('customer_impact', models.BooleanField(default=False, help_text='Does this affect customer deliverables?')),
                ('production_impact', models.BooleanField(default=False, help_text='Does this impact production schedule?')),
                ('safety_impact', models.BooleanField(default=False, help_text='Does this have safety implications?')),
                ('disposition', models.CharField(choices=[('PENDING', 'Pending Decision'), ('USE_AS_IS', 'Use As Is'), ('REWORK', 'Rework'), ('REPAIR', 'Repair'), ('SCRAP', 'Scrap'), ('RETURN_SUPPLIER', 'Return to Supplier'), ('DOWNGRADE', 'Downgrade/Recategorize')], default='PENDING', max_length=20)),
                ('disposition_reason', models.TextField(blank=True, default='')),
                ('disposition_at', models.DateTimeField(blank=True, null=True)),
                ('estimated_cost_impact', models.DecimalField(decimal_places=2, default=0, help_text='Estimated cost of the nonconformance', max_digits=12)),
                ('actual_cost_impact', models.DecimalField(decimal_places=2, default=0, help_text='Actual cost after resolution', max_digits=12)),
                ('lost_revenue', models.DecimalField(decimal_places=2, default=0, help_text='Lost revenue due to this NCR', max_digits=12)),
                ('reported_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('target_closure_date', models.DateField(blank=True, help_text='Target date to close this NCR', null=True)),
                ('actual_closure_date', models.DateField(blank=True, null=True)),
                ('assigned_to', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='ncrs_assigned', to=settings.AUTH_USER_MODEL)),
                ('closed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='ncrs_closed', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('defect_category', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='ncrs', to='quality.defectcategory')),
                ('disposition_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='ncr_dispositions', to=settings.AUTH_USER_MODEL)),
                ('reported_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='ncrs_reported', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Nonconformance Report',
                'verbose_name_plural': 'Nonconformance Reports',
                'db_table': 'quality_nonconformance_report',
                'ordering': ['-reported_at'],
            },
        ),
        migrations.CreateModel(
            name='NCRCorrectiveAction',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('action_type', models.CharField(choices=[('IMMEDIATE', 'Immediate Containment'), ('CORRECTIVE', 'Corrective Action'), ('PREVENTIVE', 'Preventive Action')], max_length=20)),
                ('description', models.TextField(help_text='What action needs to be taken')),
                ('due_date', models.DateField()),
                ('completed_date', models.DateField(blank=True, null=True)),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('IN_PROGRESS', 'In Progress'), ('COMPLETED', 'Completed'), ('VERIFIED', 'Verified Effective'), ('CANCELLED', 'Cancelled')], default='PENDING', max_length=20)),
                ('completion_notes', models.TextField(blank=True, default='', help_text='Notes on what was done to complete this action')),
                ('effectiveness_verified', models.BooleanField(default=False)),
                ('verification_notes', models.TextField(blank=True, default='')),
                ('verified_at', models.DateTimeField(blank=True, null=True)),
                ('assigned_to', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='ncr_actions_assigned', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('verified_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='ncr_actions_verified', to=settings.AUTH_USER_MODEL)),
                ('ncr', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='corrective_actions', to='quality.nonconformancereport')),
            ],
            options={
                'verbose_name': 'NCR Corrective Action',
                'verbose_name_plural': 'NCR Corrective Actions',
                'db_table': 'quality_ncr_corrective_action',
                'ordering': ['ncr', 'action_type', 'due_date'],
            },
        ),
        migrations.CreateModel(
            name='QualityDisposition',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('job_card_id', models.BigIntegerField(db_index=True, help_text='Reference to production.JobCard')),
                ('evaluation_session_id', models.BigIntegerField(blank=True, help_text='Reference to evaluation.EvaluationSession', null=True)),
                ('decision', models.CharField(choices=[('APPROVED', 'Approved - Meets All Requirements'), ('CONDITIONAL', 'Conditional Approval - With Deviations'), ('REJECTED', 'Rejected - Does Not Meet Requirements'), ('HOLD', 'On Quality Hold - Pending Review')], max_length=20)),
                ('disposition_date', models.DateTimeField(default=django.utils.timezone.now)),
                ('inspection_summary', models.TextField(help_text='Summary of inspection results supporting the decision')),
                ('deviations_accepted', models.TextField(blank=True, default='', help_text='For conditional approval - list deviations accepted')),
                ('customer_concession', models.BooleanField(default=False, help_text='Was customer concession obtained for deviations?')),
                ('concession_reference', models.CharField(blank=True, default='', help_text='Customer concession reference number', max_length=100)),
                ('criteria_results_json', models.JSONField(default=dict, help_text='Actual vs required criteria values')),
                ('coc_number', models.CharField(blank=True, default='', help_text='Certificate of Conformance number', max_length=100)),
                ('coc_generated_at', models.DateTimeField(blank=True, null=True)),
                ('customer_name', models.CharField(blank=True, default='', max_length=100)),
                ('customer_po_number', models.CharField(blank=True, default='', max_length=100)),
                ('customer_requirements_met', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True, default='')),
                ('released_for_shipment', models.BooleanField(default=False)),
                ('release_date', models.DateTimeField(blank=True, null=True)),
                ('acceptance_template', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='dispositions', to='quality.acceptancecriteriatemplate')),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('ncrs_closed', models.ManyToManyField(blank=True, related_name='dispositions', to='quality.nonconformancereport')),
                ('quality_engineer', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='quality_dispositions', to=settings.AUTH_USER_MODEL)),
                ('released_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='quality_releases', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Quality Disposition',
                'verbose_name_plural': 'Quality Dispositions',
                'db_table': 'quality_disposition',
                'ordering': ['-disposition_date'],
            },
        ),
        migrations.CreateModel(
            name='RootCauseCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('code', models.CharField(db_index=True, help_text='Category code (e.g., MAN, MACHINE, METHOD)', max_length=20, unique=True)),
                ('name', models.CharField(max_length=100)),
                ('description', models.TextField(blank=True, default='')),
                ('sort_order', models.PositiveIntegerField(default=0)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Root Cause Category',
                'verbose_name_plural': 'Root Cause Categories',
                'db_table': 'quality_root_cause_category',
                'ordering': ['sort_order', 'code'],
            },
        ),
        migrations.CreateModel(
            name='NCRRootCauseAnalysis',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('why_1', models.TextField(help_text='First Why - immediate cause')),
                ('why_2', models.TextField(blank=True, default='', help_text='Second Why')),
                ('why_3', models.TextField(blank=True, default='', help_text='Third Why')),
                ('why_4', models.TextField(blank=True, default='', help_text='Fourth Why')),
                ('why_5', models.TextField(blank=True, default='', help_text='Fifth Why - root cause')),
                ('root_cause_statement', models.TextField(help_text='Final root cause statement based on analysis')),
                ('is_systemic', models.BooleanField(default=False, help_text='Is this a systemic issue requiring broader corrective action?')),
                ('analyzed_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('analyzed_by', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='ncr_analyses', to=settings.AUTH_USER_MODEL)),
                ('created_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_created', to=settings.AUTH_USER_MODEL)),
                ('updated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='%(app_label)s_%(class)s_updated', to=settings.AUTH_USER_MODEL)),
                ('ncr', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='root_cause_analyses', to='quality.nonconformancereport')),
                ('category', models.ForeignKey(help_text='Ishikawa category (Man, Machine, Method, etc.)', on_delete=django.db.models.deletion.PROTECT, to='quality.rootcausecategory')),
            ],
            options={
                'verbose_name': 'NCR Root Cause Analysis',
                'verbose_name_plural': 'NCR Root Cause Analyses',
                'db_table': 'quality_ncr_root_cause_analysis',
                'ordering': ['ncr', 'category'],
            },
        ),
        migrations.AddIndex(
            model_name='acceptancecriteriatemplate',
            index=models.Index(fields=['code'], name='ix_qual_actempl_code'),
        ),
        migrations.AddIndex(
            model_name='acceptancecriteriatemplate',
            index=models.Index(fields=['applies_to_bit_type', 'applies_to_customer'], name='ix_qual_actempl_bit_cust'),
        ),
        migrations.AddIndex(
            model_name='acceptancecriteriatemplate',
            index=models.Index(fields=['is_active'], name='ix_qual_actempl_active'),
        ),
        migrations.AddIndex(
            model_name='calibratedequipment',
            index=models.Index(fields=['equipment_id'], name='ix_qual_caleq_id'),
        ),
        migrations.AddIndex(
            model_name='calibratedequipment',
            index=models.Index(fields=['status'], name='ix_qual_caleq_status'),
        ),
        migrations.AddIndex(
            model_name='calibratedequipment',
            index=models.Index(fields=['next_calibration_due'], name='ix_qual_caleq_due'),
        ),
        migrations.AddIndex(
            model_name='calibratedequipment',
            index=models.Index(fields=['equipment_type'], name='ix_qual_caleq_type'),
        ),
        migrations.AddIndex(
            model_name='calibratedequipment',
            index=models.Index(fields=['is_critical', 'status'], name='ix_qual_caleq_crit_stat'),
        ),
        migrations.AddIndex(
            model_name='calibrationrecord',
            index=models.Index(fields=['equipment'], name='ix_qual_calrec_equip'),
        ),
        migrations.AddIndex(
            model_name='calibrationrecord',
            index=models.Index(fields=['calibration_date'], name='ix_qual_calrec_date'),
        ),
        migrations.AddIndex(
            model_name='calibrationrecord',
            index=models.Index(fields=['certificate_number'], name='ix_qual_calrec_cert'),
        ),
        migrations.AddIndex(
            model_name='calibrationrecord',
            index=models.Index(fields=['result'], name='ix_qual_calrec_result'),
        ),
        migrations.AddIndex(
            model_name='defectcategory',
            index=models.Index(fields=['code'], name='ix_qual_defcat_code'),
        ),
        migrations.AddIndex(
            model_name='defectcategory',
            index=models.Index(fields=['is_critical'], name='ix_qual_defcat_critical'),
        ),
        migrations.AddIndex(
            model_name='nonconformancereport',
            index=models.Index(fields=['ncr_number'], name='ix_qual_ncr_number'),
        ),
        migrations.AddIndex(
            model_name='nonconformancereport',
            index=models.Index(fields=['status'], name='ix_qual_ncr_status'),
        ),
        migrations.AddIndex(
            model_name='nonconformancereport',
            index=models.Index(fields=['ncr_type'], name='ix_qual_ncr_type'),
        ),
        migrations.AddIndex(
            model_name='nonconformancereport',
            index=models.Index(fields=['severity'], name='ix_qual_ncr_severity'),
        ),
        migrations.AddIndex(
            model_name='nonconformancereport',
            index=models.Index(fields=['job_card_id'], name='ix_qual_ncr_jobcard'),
        ),
        migrations.AddIndex(
            model_name='nonconformancereport',
            index=models.Index(fields=['reported_at'], name='ix_qual_ncr_reported'),
        ),
        migrations.AddIndex(
            model_name='nonconformancereport',
            index=models.Index(fields=['status', 'severity', 'target_closure_date'], name='ix_qual_ncr_workflow'),
        ),
        migrations.AddIndex(
            model_name='ncrcorrectiveaction',
            index=models.Index(fields=['ncr'], name='ix_qual_capa_ncr'),
        ),
        migrations.AddIndex(
            model_name='ncrcorrectiveaction',
            index=models.Index(fields=['status'], name='ix_qual_capa_status'),
        ),
        migrations.AddIndex(
            model_name='ncrcorrectiveaction',
            index=models.Index(fields=['action_type'], name='ix_qual_capa_type'),
        ),
        migrations.AddIndex(
            model_name='ncrcorrectiveaction',
            index=models.Index(fields=['due_date'], name='ix_qual_capa_due'),
        ),
        migrations.AddIndex(
            model_name='ncrcorrectiveaction',
            index=models.Index(fields=['status', 'due_date'], name='ix_qual_capa_stat_due'),
        ),
        migrations.AddIndex(
            model_name='qualitydisposition',
            index=models.Index(fields=['job_card_id'], name='ix_qual_disp_jobcard'),
        ),
        migrations.AddIndex(
            model_name='qualitydisposition',
            index=models.Index(fields=['decision'], name='ix_qual_disp_decision'),
        ),
        migrations.AddIndex(
            model_name='qualitydisposition',
            index=models.Index(fields=['disposition_date'], name='ix_qual_disp_date'),
        ),
        migrations.AddIndex(
            model_name='qualitydisposition',
            index=models.Index(fields=['released_for_shipment'], name='ix_qual_disp_released'),
        ),
        migrations.AddIndex(
            model_name='qualitydisposition',
            index=models.Index(fields=['decision', 'released_for_shipment'], name='ix_qual_disp_dec_rel'),
        ),
        migrations.AddIndex(
            model_name='rootcausecategory',
            index=models.Index(fields=['code'], name='ix_qual_rccat_code'),
        ),
        migrations.AddIndex(
            model_name='ncrrootcauseanalysis',
            index=models.Index(fields=['ncr'], name='ix_qual_rca_ncr'),
        ),
        migrations.AddIndex(
            model_name='ncrrootcauseanalysis',
            index=models.Index(fields=['is_systemic'], name='ix_qual_rca_systemic'),
        ),
    ]
