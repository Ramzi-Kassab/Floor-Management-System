# Generated by Django 5.2.6 on 2025-11-17 11:31

import django.db.models.deletion
import django.utils.timezone
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        ('inventory', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='BitSection',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(help_text='Section code (e.g., CONE, NOSE, TAPER)', max_length=20, unique=True)),
                ('name', models.CharField(help_text='Full name of the section', max_length=100)),
                ('description', models.TextField(blank=True, default='', help_text="Description of this section's location and characteristics")),
                ('sequence', models.IntegerField(help_text='Order from center (1) to outer edge (5)', unique=True)),
                ('color_code', models.CharField(default='#808080', help_text='Hex color for UI display', max_length=7)),
                ('is_active', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Bit Section',
                'verbose_name_plural': 'Bit Sections',
                'db_table': 'evaluation_bit_section',
                'ordering': ['sequence'],
            },
        ),
        migrations.CreateModel(
            name='BitType',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(help_text='Bit type code (e.g., HDBS, SMI)', max_length=50, unique=True)),
                ('name', models.CharField(help_text='Full name of the bit type', max_length=200)),
                ('description', models.TextField(blank=True, default='', help_text='Description of this bit type and its characteristics')),
                ('manufacturer', models.CharField(blank=True, default='', help_text='Original manufacturer/designer', max_length=200)),
                ('sort_order', models.IntegerField(default=0)),
                ('is_active', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Bit Type',
                'verbose_name_plural': 'Bit Types',
                'db_table': 'evaluation_bit_type',
                'ordering': ['sort_order', 'code'],
            },
        ),
        migrations.CreateModel(
            name='CutterEvaluationCode',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(help_text='Single character code (e.g., X, O, S, R, L)', max_length=10, unique=True)),
                ('name', models.CharField(help_text='Full name of the evaluation code', max_length=100)),
                ('description', models.TextField(blank=True, default='', help_text='Detailed description of what this code means')),
                ('action', models.CharField(choices=[('REPLACE', 'Replace Cutter'), ('KEEP', 'Keep As Is'), ('BRAZE_FILL', 'Braze Fill Repair'), ('ROTATE', 'Rotate Cutter'), ('LOST', 'Lost/Missing')], help_text='Required action for this evaluation code', max_length=20)),
                ('color_code', models.CharField(default='#FFFFFF', help_text='Hex color for UI display (e.g., #FF0000 for red)', max_length=7)),
                ('sort_order', models.IntegerField(default=0, help_text='Display order in UI')),
                ('is_active', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Cutter Evaluation Code',
                'verbose_name_plural': 'Cutter Evaluation Codes',
                'db_table': 'evaluation_cutter_evaluation_code',
                'ordering': ['sort_order', 'code'],
            },
        ),
        migrations.CreateModel(
            name='FeatureCode',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(help_text='Feature code (e.g., V, P, I, B)', max_length=10, unique=True)),
                ('name', models.CharField(help_text='Full name of the feature code', max_length=100)),
                ('description', models.TextField(blank=True, default='', help_text='Detailed description of the feature issue')),
                ('geometry_type', models.CharField(choices=[('FIN', 'Fin/Blade Geometry'), ('POCKET', 'Cutter Pocket'), ('BODY', 'Bit Body'), ('OTHER', 'Other Feature')], help_text='Type of geometry this feature relates to', max_length=20)),
                ('color_code', models.CharField(default='#FFFF00', help_text='Hex color for UI display', max_length=7)),
                ('sort_order', models.IntegerField(default=0)),
                ('is_active', models.BooleanField(default=True)),
            ],
            options={
                'verbose_name': 'Feature Code',
                'verbose_name_plural': 'Feature Codes',
                'db_table': 'evaluation_feature_code',
                'ordering': ['sort_order', 'code'],
            },
        ),
        migrations.CreateModel(
            name='NDTInspection',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('method', models.CharField(choices=[('LPT', 'Liquid Penetrant Testing'), ('MPI', 'Magnetic Particle Inspection'), ('UT', 'Ultrasonic Testing'), ('RT', 'Radiographic Testing'), ('VT', 'Visual Testing'), ('OTHER', 'Other Method')], help_text='NDT method used', max_length=20)),
                ('result', models.CharField(choices=[('PASS', 'Pass - No Defects'), ('FAIL', 'Fail - Critical Defects'), ('REPAIR_REQUIRED', 'Repair Required'), ('MONITOR', 'Monitor - Acceptable with Conditions'), ('INCONCLUSIVE', 'Inconclusive - Retest Required')], db_index=True, help_text='Overall inspection result', max_length=20)),
                ('areas_inspected', models.TextField(help_text='Description of areas inspected (e.g., body, blades, shank)')),
                ('indications_description', models.TextField(blank=True, default='', help_text='Description of any indications/defects found')),
                ('crack_indications', models.BooleanField(default=False, help_text='Whether crack indications were found')),
                ('porosity_indications', models.BooleanField(default=False, help_text='Whether porosity indications were found')),
                ('inclusion_indications', models.BooleanField(default=False, help_text='Whether inclusion indications were found')),
                ('max_indication_size', models.DecimalField(blank=True, decimal_places=3, help_text='Maximum indication size (mm)', max_digits=8, null=True)),
                ('indication_count', models.PositiveIntegerField(default=0, help_text='Number of indications found')),
                ('acceptance_standard', models.CharField(blank=True, default='', help_text='Standard used for acceptance (e.g., ASME, API, company standard)', max_length=100)),
                ('meets_acceptance_criteria', models.BooleanField(default=True, help_text='Whether findings meet acceptance criteria')),
                ('recommendations', models.TextField(blank=True, default='', help_text='Recommendations based on findings')),
                ('requires_retest', models.BooleanField(default=False, help_text='Whether a retest is required')),
                ('retest_due_date', models.DateField(blank=True, help_text='When retest should be performed', null=True)),
                ('equipment_used', models.CharField(blank=True, default='', help_text='Equipment/instrument used for inspection', max_length=200)),
                ('calibration_date', models.DateField(blank=True, help_text='Last calibration date of equipment', null=True)),
                ('inspector_certification', models.CharField(blank=True, default='', help_text="Inspector's certification level (e.g., Level II)", max_length=100)),
                ('inspected_at', models.DateTimeField(default=django.utils.timezone.now, help_text='When the inspection was performed')),
                ('report_number', models.CharField(blank=True, default='', help_text='NDT report reference number', max_length=100)),
                ('attachment_refs', models.JSONField(blank=True, default=list, help_text='References to attached reports/images')),
            ],
            options={
                'verbose_name': 'NDT Inspection',
                'verbose_name_plural': 'NDT Inspections',
                'db_table': 'evaluation_ndt_inspection',
                'ordering': ['-inspected_at'],
            },
        ),
        migrations.CreateModel(
            name='RequirementInstance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('PENDING', 'Pending'), ('SATISFIED', 'Satisfied'), ('NOT_APPLICABLE', 'Not Applicable'), ('WAIVED', 'Waived')], db_index=True, default='PENDING', help_text='Current status of the requirement', max_length=20)),
                ('satisfied_at', models.DateTimeField(blank=True, help_text='When the requirement was satisfied', null=True)),
                ('notes', models.TextField(blank=True, default='', help_text='Notes about satisfaction or waiver')),
                ('evidence_refs', models.JSONField(blank=True, default=list, help_text='References to evidence documents/files')),
                ('waiver_reason', models.TextField(blank=True, default='', help_text='Reason for waiving the requirement')),
                ('due_at', models.DateTimeField(blank=True, help_text='When this requirement is due', null=True)),
                ('created_at', models.DateTimeField(auto_now_add=True, help_text='When this instance was created')),
                ('updated_at', models.DateTimeField(auto_now=True, help_text='When this instance was last updated')),
            ],
            options={
                'verbose_name': 'Requirement Instance',
                'verbose_name_plural': 'Requirement Instances',
                'db_table': 'evaluation_requirement_instance',
                'ordering': ['-template__is_mandatory', 'template__sort_order'],
            },
        ),
        migrations.CreateModel(
            name='RequirementTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(help_text='Unique requirement code (e.g., NDT_CERT_CHECK)', max_length=50, unique=True)),
                ('name', models.CharField(help_text='Human-readable requirement name', max_length=200)),
                ('description', models.TextField(blank=True, default='', help_text='Detailed description of the requirement')),
                ('stage', models.CharField(choices=[('PRE_PRODUCTION', 'Pre-Production'), ('EVALUATION', 'During Evaluation'), ('PROCESSING', 'During Processing'), ('FINAL_QC', 'Final QC'), ('SHIPPING', 'Before Shipping')], db_index=True, default='EVALUATION', help_text='Production stage when this requirement applies', max_length=20)),
                ('requirement_type', models.CharField(choices=[('DOCUMENT', 'Document Required'), ('APPROVAL', 'Approval Required'), ('MATERIAL', 'Material Required'), ('DATA', 'Data/Measurement Required'), ('INSPECTION', 'Inspection Required'), ('CERTIFICATION', 'Certification Required')], help_text='Type of requirement', max_length=20)),
                ('is_mandatory', models.BooleanField(default=True, help_text='If True, cannot proceed without satisfying this requirement')),
                ('can_be_waived', models.BooleanField(default=False, help_text='Can be waived by authorized personnel')),
                ('waiver_authority', models.CharField(blank=True, default='', help_text='Role/position that can authorize waiver', max_length=100)),
                ('condition_json', models.JSONField(blank=True, default=dict, help_text='Conditions under which this requirement applies')),
                ('satisfaction_instructions', models.TextField(blank=True, default='', help_text='How to satisfy this requirement')),
                ('reference_documents', models.JSONField(blank=True, default=list, help_text='List of reference document codes/links')),
                ('lead_time_hours', models.IntegerField(default=0, help_text='Expected hours needed to satisfy this requirement')),
                ('sort_order', models.IntegerField(default=0)),
                ('icon', models.CharField(blank=True, default='', help_text='Icon name for UI display', max_length=50)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Requirement Template',
                'verbose_name_plural': 'Requirement Templates',
                'db_table': 'evaluation_requirement_template',
                'ordering': ['stage', 'sort_order', 'code'],
            },
        ),
        migrations.CreateModel(
            name='TechnicalInstructionInstance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('resolved_text', models.TextField(help_text='Final instruction text with placeholders filled in')),
                ('stage', models.CharField(choices=[('PRE_PRODUCTION', 'Pre-Production'), ('EVALUATION', 'During Evaluation'), ('PROCESSING', 'During Processing'), ('FINAL_QC', 'Final QC')], db_index=True, help_text='Production stage for this instruction', max_length=20)),
                ('severity', models.CharField(choices=[('INFO', 'Information'), ('WARNING', 'Warning'), ('CRITICAL', 'Critical')], db_index=True, help_text='Severity level of this instruction', max_length=10)),
                ('status', models.CharField(choices=[('SUGGESTED', 'Suggested'), ('ACCEPTED', 'Accepted'), ('REJECTED', 'Rejected'), ('OVERRIDDEN', 'Overridden'), ('ACKNOWLEDGED', 'Acknowledged')], db_index=True, default='SUGGESTED', help_text='Current status of the instruction', max_length=20)),
                ('override_reason', models.TextField(blank=True, default='', help_text='Reason for overriding/rejecting the instruction')),
                ('acknowledged_at', models.DateTimeField(blank=True, help_text='When the instruction was acknowledged', null=True)),
                ('context_data', models.JSONField(blank=True, default=dict, help_text='Snapshot of data used to generate this instruction')),
                ('generated_at', models.DateTimeField(default=django.utils.timezone.now, help_text='When this instruction was generated')),
                ('resolved_at', models.DateTimeField(blank=True, help_text='When the instruction was resolved (accepted/rejected/overridden)', null=True)),
                ('priority', models.IntegerField(default=100, help_text='Priority for display ordering')),
            ],
            options={
                'verbose_name': 'Technical Instruction Instance',
                'verbose_name_plural': 'Technical Instruction Instances',
                'db_table': 'evaluation_technical_instruction_instance',
                'ordering': ['-priority', '-severity', '-generated_at'],
            },
        ),
        migrations.CreateModel(
            name='TechnicalInstructionTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(help_text='Unique template code (e.g., GAUGE_REPAIR_CHECK)', max_length=50, unique=True)),
                ('name', models.CharField(help_text='Human-readable template name', max_length=200)),
                ('description', models.TextField(blank=True, default='', help_text='Description of what this instruction template does')),
                ('scope', models.CharField(choices=[('EVALUATION_SESSION', 'Evaluation Session Level'), ('CELL_LEVEL', 'Individual Cell Level'), ('THREAD_LEVEL', 'Thread Inspection Level'), ('NDT_LEVEL', 'NDT Inspection Level')], default='EVALUATION_SESSION', help_text='Level at which this instruction applies', max_length=30)),
                ('stage', models.CharField(choices=[('PRE_PRODUCTION', 'Pre-Production'), ('EVALUATION', 'During Evaluation'), ('PROCESSING', 'During Processing'), ('FINAL_QC', 'Final QC')], db_index=True, default='EVALUATION', help_text='Production stage when this instruction is relevant', max_length=20)),
                ('severity', models.CharField(choices=[('INFO', 'Information'), ('WARNING', 'Warning'), ('CRITICAL', 'Critical')], db_index=True, default='INFO', help_text='Severity level of the instruction', max_length=10)),
                ('condition_json', models.JSONField(default=dict, help_text='JSON structure defining conditions that trigger this instruction')),
                ('output_template', models.TextField(help_text="Text template with placeholders (e.g., '{count} cutters need replacement in {section}')")),
                ('auto_generate', models.BooleanField(default=True, help_text='Automatically generate when conditions are met')),
                ('requires_acknowledgment', models.BooleanField(default=False, help_text='Requires user acknowledgment before proceeding')),
                ('can_be_overridden', models.BooleanField(default=True, help_text='Can be overridden by authorized personnel')),
                ('override_requires_approval', models.BooleanField(default=False, help_text='Override requires higher-level approval')),
                ('priority', models.IntegerField(default=100, help_text='Higher priority instructions are processed first')),
                ('version', models.PositiveIntegerField(default=1, help_text='Template version number')),
                ('effective_from', models.DateTimeField(blank=True, help_text='When this template version becomes effective', null=True)),
                ('effective_to', models.DateTimeField(blank=True, help_text='When this template version expires', null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Technical Instruction Template',
                'verbose_name_plural': 'Technical Instruction Templates',
                'db_table': 'evaluation_technical_instruction_template',
                'ordering': ['-priority', 'stage', 'code'],
            },
        ),
        migrations.CreateModel(
            name='ThreadInspection',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('thread_type', models.CharField(choices=[('API_REG', 'API Regular'), ('API_IF', 'API Internal Flush'), ('API_FH', 'API Full Hole'), ('API_NC', 'API Numbered Connection'), ('HT', 'Hi-Torque'), ('OTHER', 'Other')], default='API_REG', help_text='Type of thread connection', max_length=20)),
                ('connection_type', models.CharField(choices=[('PIN', 'Pin (Male)'), ('BOX', 'Box (Female)')], default='PIN', help_text='Connection type (pin or box)', max_length=10)),
                ('thread_size', models.CharField(blank=True, default='', help_text='Thread size specification (e.g., 4-1/2 REG)', max_length=50)),
                ('result', models.CharField(choices=[('OK', 'OK - No Issues'), ('MINOR_DAMAGE', 'Minor Damage - Acceptable'), ('MAJOR_DAMAGE', 'Major Damage - Needs Attention'), ('REPAIRABLE', 'Repairable'), ('SCRAP', 'Scrap - Beyond Repair')], db_index=True, help_text='Overall inspection result', max_length=20)),
                ('description', models.TextField(blank=True, default='', help_text='Detailed description of findings')),
                ('measurements_json', models.JSONField(blank=True, default=dict, help_text='Thread measurements (pitch diameter, lead, taper, etc.)')),
                ('thread_crest_condition', models.CharField(blank=True, default='', help_text='Condition of thread crests', max_length=100)),
                ('thread_root_condition', models.CharField(blank=True, default='', help_text='Condition of thread roots', max_length=100)),
                ('shoulder_condition', models.CharField(blank=True, default='', help_text='Condition of thread shoulder', max_length=100)),
                ('galling_observed', models.BooleanField(default=False, help_text='Whether galling was observed')),
                ('corrosion_observed', models.BooleanField(default=False, help_text='Whether corrosion was observed')),
                ('repair_recommendation', models.TextField(blank=True, default='', help_text='Recommended repair actions')),
                ('requires_recut', models.BooleanField(default=False, help_text='Whether thread needs recutting')),
                ('requires_replacement', models.BooleanField(default=False, help_text='Whether connection needs replacement')),
                ('inspected_at', models.DateTimeField(default=django.utils.timezone.now, help_text='When the inspection was performed')),
                ('attachment_refs', models.JSONField(blank=True, default=list, help_text='References to attached documents/images')),
            ],
            options={
                'verbose_name': 'Thread Inspection',
                'verbose_name_plural': 'Thread Inspections',
                'db_table': 'evaluation_thread_inspection',
                'ordering': ['-inspected_at'],
            },
        ),
        migrations.CreateModel(
            name='EvaluationCell',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('blade_number', models.PositiveIntegerField(help_text='Blade/row number (1-based)')),
                ('position_index', models.PositiveIntegerField(help_text='Position index within the section (1-based)')),
                ('is_primary', models.BooleanField(default=True, help_text='True if primary cutter, False if secondary/backup cutter')),
                ('notes', models.TextField(blank=True, default='', help_text='Specific notes for this cell/cutter')),
                ('has_fin_build_up', models.BooleanField(default=False, help_text='V code: Material build-up on fin geometry')),
                ('fin_number', models.PositiveIntegerField(blank=True, help_text='If has_fin_build_up, which fin number is affected', null=True)),
                ('has_pocket_damage', models.BooleanField(default=False, help_text='P code: Damage to cutter pocket')),
                ('has_impact_arrestor_issue', models.BooleanField(default=False, help_text='I code: Issue with impact arrestor')),
                ('has_body_build_up', models.BooleanField(default=False, help_text='B code: Material build-up on bit body')),
                ('pocket_diameter', models.DecimalField(blank=True, decimal_places=3, help_text='Measured pocket diameter (mm)', max_digits=8, null=True)),
                ('pocket_depth', models.DecimalField(blank=True, decimal_places=3, help_text='Measured pocket depth (mm)', max_digits=8, null=True)),
                ('cutter_exposure', models.DecimalField(blank=True, decimal_places=3, help_text='Cutter exposure above pocket (mm)', max_digits=8, null=True)),
                ('wear_flat_length', models.DecimalField(blank=True, decimal_places=3, help_text='Length of wear flat on cutter (mm)', max_digits=8, null=True)),
                ('back_rake_angle', models.DecimalField(blank=True, decimal_places=2, help_text='Back rake angle (degrees)', max_digits=6, null=True)),
                ('side_rake_angle', models.DecimalField(blank=True, decimal_places=2, help_text='Side rake angle (degrees)', max_digits=6, null=True)),
                ('evaluated_at', models.DateTimeField(auto_now_add=True, help_text='When this cell was evaluated')),
                ('last_modified_at', models.DateTimeField(auto_now=True, help_text='When this cell was last modified')),
                ('cutter_code', models.ForeignKey(blank=True, help_text='Evaluation code assigned to this cutter', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='evaluation_cells', to='evaluation.cutterevaluationcode')),
                ('cutter_item', models.ForeignKey(blank=True, help_text='Cutter design/item installed at this position', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='evaluation_cells', to='inventory.item')),
                ('section', models.ForeignKey(help_text='Bit section (cone, nose, taper, shoulder, gauge)', on_delete=django.db.models.deletion.PROTECT, related_name='evaluation_cells', to='evaluation.bitsection')),
            ],
            options={
                'verbose_name': 'Evaluation Cell',
                'verbose_name_plural': 'Evaluation Cells',
                'db_table': 'evaluation_cell',
                'ordering': ['evaluation_session', 'blade_number', 'section__sequence', 'position_index'],
            },
        ),
        migrations.CreateModel(
            name='EvaluationChangeLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('change_stage', models.CharField(choices=[('EVALUATOR', 'Evaluator Stage'), ('ENGINEER', 'Engineering Review'), ('ADMIN', 'Administrative Override'), ('SYSTEM', 'System Generated')], db_index=True, help_text='Stage/role when change was made', max_length=20)),
                ('change_type', models.CharField(choices=[('CREATE', 'Record Created'), ('UPDATE', 'Field Updated'), ('DELETE', 'Record Deleted'), ('RESTORE', 'Record Restored'), ('STATUS_CHANGE', 'Status Changed'), ('APPROVAL', 'Approval Action'), ('OVERRIDE', 'Override Action')], db_index=True, default='UPDATE', help_text='Type of change', max_length=20)),
                ('model_name', models.CharField(help_text='Name of the model that was changed', max_length=100)),
                ('object_id', models.BigIntegerField(blank=True, help_text='ID of the specific object changed', null=True)),
                ('field_changed', models.CharField(blank=True, default='', help_text='Specific field that was modified', max_length=100)),
                ('old_value', models.TextField(blank=True, default='', help_text='Previous value (serialized)')),
                ('new_value', models.TextField(blank=True, default='', help_text='New value (serialized)')),
                ('reason', models.TextField(blank=True, default='', help_text='Reason for the change')),
                ('additional_context', models.JSONField(blank=True, default=dict, help_text='Additional context data for the change')),
                ('ip_address', models.GenericIPAddressField(blank=True, help_text='IP address of the user', null=True)),
                ('user_agent', models.CharField(blank=True, default='', help_text='User agent/browser information', max_length=500)),
                ('changed_at', models.DateTimeField(db_index=True, default=django.utils.timezone.now, help_text='When the change was made')),
                ('changed_by', models.ForeignKey(help_text='User who made the change', on_delete=django.db.models.deletion.PROTECT, related_name='evaluation_changes', to=settings.AUTH_USER_MODEL)),
                ('evaluation_cell', models.ForeignKey(blank=True, help_text='Specific cell that was changed (if applicable)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='change_logs', to='evaluation.evaluationcell')),
            ],
            options={
                'verbose_name': 'Evaluation Change Log',
                'verbose_name_plural': 'Evaluation Change Logs',
                'db_table': 'evaluation_change_log',
                'ordering': ['-changed_at'],
            },
        ),
        migrations.CreateModel(
            name='EvaluationSession',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('created_at', models.DateTimeField(auto_now_add=True, db_index=True)),
                ('updated_at', models.DateTimeField(auto_now=True, db_index=True)),
                ('remarks', models.CharField(blank=True, default='', max_length=255)),
                ('is_deleted', models.BooleanField(db_index=True, default=False, editable=False)),
                ('deleted_at', models.DateTimeField(blank=True, editable=False, null=True)),
                ('public_id', models.UUIDField(db_index=True, default=uuid.uuid4, editable=False, unique=True)),
                ('context', models.CharField(choices=[('NEW_BIT', 'New Bit Production'), ('AFTER_RUN', 'After Run Evaluation'), ('REPAIR_INTAKE', 'Repair Intake'), ('POST_REPAIR', 'Post-Repair Verification'), ('RECLAIM_ONLY', 'Reclaim/Salvage Only'), ('RETROFIT_INTENT', 'Retrofit Intent Evaluation')], db_index=True, default='REPAIR_INTAKE', help_text='Context/purpose of this evaluation', max_length=30)),
                ('customer_name', models.CharField(blank=True, default='', help_text='Customer name (denormalized for quick access)', max_length=200)),
                ('project_name', models.CharField(blank=True, default='', help_text='Project/well/field name', max_length=200)),
                ('status', models.CharField(choices=[('DRAFT', 'Draft'), ('UNDER_REVIEW', 'Under Review'), ('APPROVED', 'Approved'), ('LOCKED', 'Locked')], db_index=True, default='DRAFT', help_text='Current workflow status of the evaluation', max_length=20)),
                ('submitted_at', models.DateTimeField(blank=True, help_text='When evaluation was submitted for review', null=True)),
                ('approved_at', models.DateTimeField(blank=True, help_text='When evaluation was approved', null=True)),
                ('locked_at', models.DateTimeField(blank=True, help_text='When evaluation was locked (no further changes)', null=True)),
                ('is_last_known_state', models.BooleanField(db_index=True, default=False, help_text='True if this is the most recent evaluation for the serial unit')),
                ('total_cells', models.IntegerField(default=0, help_text='Total number of cells evaluated')),
                ('replace_count', models.IntegerField(default=0, help_text='Number of cutters marked for replacement (X code)')),
                ('ok_count', models.IntegerField(default=0, help_text='Number of cutters marked as OK (O code)')),
                ('braze_count', models.IntegerField(default=0, help_text='Number of cutters needing braze fill (S code)')),
                ('rotate_count', models.IntegerField(default=0, help_text='Number of cutters to rotate (R code)')),
                ('lost_count', models.IntegerField(default=0, help_text='Number of cutters lost/missing (L code)')),
                ('general_notes', models.TextField(blank=True, default='', help_text='General notes about the evaluation')),
                ('wear_pattern_notes', models.TextField(blank=True, default='', help_text='Notes about observed wear patterns')),
                ('damage_assessment', models.TextField(blank=True, default='', help_text='Overall damage assessment')),
                ('recommendations', models.TextField(blank=True, default='', help_text='Recommendations for repair/action')),
                ('approved_by', models.ForeignKey(blank=True, help_text='User who approved the evaluation', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='evaluations_approved', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Evaluation Session',
                'verbose_name_plural': 'Evaluation Sessions',
                'db_table': 'evaluation_session',
                'ordering': ['-created_at'],
            },
        ),
    ]
