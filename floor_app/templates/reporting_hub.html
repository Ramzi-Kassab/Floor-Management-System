{% extends 'base.html' %}
{% load static %}

{% block title %}Reporting Hub{% endblock %}

{% block extra_css %}
<style>
    .hub-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 2rem;
        border-radius: 10px;
        margin-bottom: 2rem;
    }
    .report-card {
        background: white;
        border-radius: 10px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        transition: all 0.3s;
        border: 2px solid transparent;
        cursor: pointer;
    }
    .report-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        border-color: #667eea;
    }
    .report-icon {
        width: 60px;
        height: 60px;
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        color: white;
        margin-bottom: 1rem;
    }
    .icon-production { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .icon-inventory { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); }
    .icon-quality { background: linear-gradient(135deg, #dc3545 0%, #fd7e14 100%); }
    .icon-hr { background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%); }
    .icon-sales { background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); }
    .icon-financial { background: linear-gradient(135deg, #6f42c1 0%, #553d9d 100%); }
    .icon-maintenance { background: linear-gradient(135deg, #fd7e14 0%, #e8590c 100%); }
    .icon-planning { background: linear-gradient(135deg, #e83e8c 0%, #c2185b 100%); }
    .schedule-badge {
        display: inline-block;
        padding: 0.3rem 0.8rem;
        background: #e9ecef;
        border-radius: 15px;
        font-size: 0.8rem;
        margin-right: 0.5rem;
    }
    .schedule-badge.daily { background: #d4edda; color: #155724; }
    .schedule-badge.weekly { background: #cce5ff; color: #004085; }
    .schedule-badge.monthly { background: #f8d7da; color: #721c24; }
    .export-btn {
        width: 100%;
        margin-bottom: 0.5rem;
    }
    .recent-report {
        padding: 0.75rem;
        border: 1px solid #dee2e6;
        border-radius: 5px;
        margin-bottom: 0.5rem;
        transition: all 0.2s;
    }
    .recent-report:hover {
        background: #f8f9fa;
        border-color: #667eea;
    }
    .category-nav {
        background: white;
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1.5rem;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .category-btn {
        padding: 0.75rem 1.5rem;
        background: white;
        border: 2px solid #dee2e6;
        border-radius: 25px;
        margin: 0.25rem;
        cursor: pointer;
        transition: all 0.2s;
        font-weight: 600;
    }
    .category-btn:hover {
        border-color: #667eea;
        color: #667eea;
    }
    .category-btn.active {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-color: #667eea;
    }
    .custom-report-builder {
        background: #f8f9fa;
        border-radius: 10px;
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <!-- Header -->
    <div class="hub-header">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h1><i class="fas fa-file-alt"></i> Reporting Hub</h1>
                <p class="mb-0">Generate, schedule, and export reports across all modules</p>
            </div>
            <div>
                <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#customReportModal">
                    <i class="fas fa-magic"></i> Custom Report Builder
                </button>
            </div>
        </div>
    </div>

    <!-- Category Navigation -->
    <div class="category-nav">
        <div class="text-center">
            <button class="category-btn active" onclick="filterCategory('all')">
                <i class="fas fa-th"></i> All Reports
            </button>
            <button class="category-btn" onclick="filterCategory('production')">
                <i class="fas fa-industry"></i> Production
            </button>
            <button class="category-btn" onclick="filterCategory('inventory')">
                <i class="fas fa-boxes"></i> Inventory
            </button>
            <button class="category-btn" onclick="filterCategory('quality')">
                <i class="fas fa-clipboard-check"></i> Quality
            </button>
            <button class="category-btn" onclick="filterCategory('hr')">
                <i class="fas fa-users"></i> HR
            </button>
            <button class="category-btn" onclick="filterCategory('sales')">
                <i class="fas fa-dollar-sign"></i> Sales
            </button>
            <button class="category-btn" onclick="filterCategory('maintenance')">
                <i class="fas fa-wrench"></i> Maintenance
            </button>
            <button class="category-btn" onclick="filterCategory('financial')">
                <i class="fas fa-chart-line"></i> Financial
            </button>
        </div>
    </div>

    <div class="row">
        <div class="col-md-9">
            <!-- Production Reports -->
            <h5 class="mb-3"><i class="fas fa-industry"></i> Production Reports</h5>
            <div class="row" data-category="production">
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('production-summary')">
                        <div class="report-icon icon-production">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <h6>Production Summary</h6>
                        <p class="text-muted small mb-2">Overview of production output, OEE, and work center utilization</p>
                        <span class="schedule-badge daily"><i class="fas fa-clock"></i> Daily</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> PDF, Excel</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('job-status')">
                        <div class="report-icon icon-production">
                            <i class="fas fa-tasks"></i>
                        </div>
                        <h6>Job Status Report</h6>
                        <p class="text-muted small mb-2">Current status of all production jobs with completion estimates</p>
                        <span class="schedule-badge weekly"><i class="fas fa-clock"></i> Weekly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel, CSV</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('bottleneck-analysis')">
                        <div class="report-icon icon-production">
                            <i class="fas fa-hourglass-half"></i>
                        </div>
                        <h6>Bottleneck Analysis</h6>
                        <p class="text-muted small mb-2">Identify production constraints and capacity bottlenecks</p>
                        <span class="schedule-badge weekly"><i class="fas fa-clock"></i> Weekly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> PDF, Excel</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('oee-analysis')">
                        <div class="report-icon icon-production">
                            <i class="fas fa-tachometer-alt"></i>
                        </div>
                        <h6>OEE Detailed Analysis</h6>
                        <p class="text-muted small mb-2">Overall Equipment Effectiveness breakdown by work center</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel, PDF</span>
                    </div>
                </div>
            </div>

            <!-- Inventory Reports -->
            <h5 class="mb-3 mt-4"><i class="fas fa-boxes"></i> Inventory Reports</h5>
            <div class="row" data-category="inventory">
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('stock-levels')">
                        <div class="report-icon icon-inventory">
                            <i class="fas fa-warehouse"></i>
                        </div>
                        <h6>Stock Levels Report</h6>
                        <p class="text-muted small mb-2">Current inventory levels with reorder point alerts</p>
                        <span class="schedule-badge daily"><i class="fas fa-clock"></i> Daily</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel, CSV</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('abc-analysis')">
                        <div class="report-icon icon-inventory">
                            <i class="fas fa-layer-group"></i>
                        </div>
                        <h6>ABC Analysis</h6>
                        <p class="text-muted small mb-2">Inventory classification by value contribution</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> PDF, Excel</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('slow-moving')">
                        <div class="report-icon icon-inventory">
                            <i class="fas fa-turtle"></i>
                        </div>
                        <h6>Slow-Moving Inventory</h6>
                        <p class="text-muted small mb-2">Items with no movement for extended periods</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel, CSV</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('inventory-valuation')">
                        <div class="report-icon icon-inventory">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <h6>Inventory Valuation</h6>
                        <p class="text-muted small mb-2">Total inventory value breakdown by category and location</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> PDF, Excel</span>
                    </div>
                </div>
            </div>

            <!-- Quality Reports -->
            <h5 class="mb-3 mt-4"><i class="fas fa-clipboard-check"></i> Quality Reports</h5>
            <div class="row" data-category="quality">
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('quality-metrics')">
                        <div class="report-icon icon-quality">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h6>Quality Metrics Dashboard</h6>
                        <p class="text-muted small mb-2">Quality rate, NCRs, inspection results, and trends</p>
                        <span class="schedule-badge weekly"><i class="fas fa-clock"></i> Weekly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> PDF, Excel</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('ncr-summary')">
                        <div class="report-icon icon-quality">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <h6>NCR Summary</h6>
                        <p class="text-muted small mb-2">Non-conformance reports with root cause analysis</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel, PDF</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('pareto-analysis')">
                        <div class="report-icon icon-quality">
                            <i class="fas fa-chart-bar"></i>
                        </div>
                        <h6>Pareto Analysis</h6>
                        <p class="text-muted small mb-2">Top defect categories accounting for quality issues</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> PDF</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('cost-of-quality')">
                        <div class="report-icon icon-quality">
                            <i class="fas fa-money-bill-wave"></i>
                        </div>
                        <h6>Cost of Quality</h6>
                        <p class="text-muted small mb-2">Quality costs breakdown: prevention, appraisal, failure</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel</span>
                    </div>
                </div>
            </div>

            <!-- HR Reports -->
            <h5 class="mb-3 mt-4"><i class="fas fa-users"></i> HR Reports</h5>
            <div class="row" data-category="hr">
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('headcount')">
                        <div class="report-icon icon-hr">
                            <i class="fas fa-users"></i>
                        </div>
                        <h6>Headcount Report</h6>
                        <p class="text-muted small mb-2">Employee count by department, position, and status</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel, PDF</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('turnover')">
                        <div class="report-icon icon-hr">
                            <i class="fas fa-exchange-alt"></i>
                        </div>
                        <h6>Turnover Analysis</h6>
                        <p class="text-muted small mb-2">Employee turnover rates and retention metrics</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('training-compliance')">
                        <div class="report-icon icon-hr">
                            <i class="fas fa-graduation-cap"></i>
                        </div>
                        <h6>Training Compliance</h6>
                        <p class="text-muted small mb-2">Training completion rates by department and certification</p>
                        <span class="schedule-badge weekly"><i class="fas fa-clock"></i> Weekly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> PDF, Excel</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('attendance')">
                        <div class="report-icon icon-hr">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <h6>Attendance Report</h6>
                        <p class="text-muted small mb-2">Employee attendance and absenteeism tracking</p>
                        <span class="schedule-badge weekly"><i class="fas fa-clock"></i> Weekly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> CSV, Excel</span>
                    </div>
                </div>
            </div>

            <!-- Maintenance Reports -->
            <h5 class="mb-3 mt-4"><i class="fas fa-wrench"></i> Maintenance Reports</h5>
            <div class="row" data-category="maintenance">
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('pm-compliance')">
                        <div class="report-icon icon-maintenance">
                            <i class="fas fa-clipboard-check"></i>
                        </div>
                        <h6>PM Compliance Report</h6>
                        <p class="text-muted small mb-2">Preventive maintenance completion rates and overdue tasks</p>
                        <span class="schedule-badge weekly"><i class="fas fa-clock"></i> Weekly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> PDF, Excel</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('mtbf-mttr')">
                        <div class="report-icon icon-maintenance">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <h6>MTBF/MTTR Analysis</h6>
                        <p class="text-muted small mb-2">Mean time between failures and mean time to repair metrics</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel, PDF</span>
                    </div>
                </div>
            </div>

            <!-- Financial Reports -->
            <h5 class="mb-3 mt-4"><i class="fas fa-chart-line"></i> Financial Reports</h5>
            <div class="row" data-category="financial">
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('cost-analysis')">
                        <div class="report-icon icon-financial">
                            <i class="fas fa-dollar-sign"></i>
                        </div>
                        <h6>Cost Analysis</h6>
                        <p class="text-muted small mb-2">Production costs breakdown by job, material, labor</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel, PDF</span>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="report-card" onclick="generateReport('profitability')">
                        <div class="report-icon icon-financial">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        <h6>Profitability Report</h6>
                        <p class="text-muted small mb-2">Revenue, costs, and profit margins by product line</p>
                        <span class="schedule-badge monthly"><i class="fas fa-clock"></i> Monthly</span>
                        <span class="schedule-badge"><i class="fas fa-download"></i> Excel</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Sidebar -->
        <div class="col-md-3">
            <!-- Quick Export -->
            <div class="report-card">
                <h6 class="mb-3"><i class="fas fa-download"></i> Quick Export</h6>
                <button class="btn btn-outline-success export-btn">
                    <i class="fas fa-file-excel"></i> Export to Excel
                </button>
                <button class="btn btn-outline-danger export-btn">
                    <i class="fas fa-file-pdf"></i> Export to PDF
                </button>
                <button class="btn btn-outline-info export-btn">
                    <i class="fas fa-file-csv"></i> Export to CSV
                </button>
                <button class="btn btn-outline-primary export-btn">
                    <i class="fas fa-envelope"></i> Email Report
                </button>
            </div>

            <!-- Scheduled Reports -->
            <div class="report-card">
                <h6 class="mb-3"><i class="fas fa-clock"></i> Scheduled Reports</h6>
                <div class="list-group list-group-flush">
                    <div class="list-group-item px-0">
                        <strong>Production Summary</strong>
                        <br><small class="text-muted">Daily at 8:00 AM</small>
                    </div>
                    <div class="list-group-item px-0">
                        <strong>Stock Levels</strong>
                        <br><small class="text-muted">Daily at 6:00 PM</small>
                    </div>
                    <div class="list-group-item px-0">
                        <strong>Quality Metrics</strong>
                        <br><small class="text-muted">Weekly on Monday</small>
                    </div>
                </div>
                <button class="btn btn-sm btn-outline-primary w-100 mt-2">
                    <i class="fas fa-cog"></i> Manage Schedules
                </button>
            </div>

            <!-- Recent Reports -->
            <div class="report-card">
                <h6 class="mb-3"><i class="fas fa-history"></i> Recent Reports</h6>
                <div class="recent-report">
                    <div class="d-flex justify-content-between">
                        <strong><i class="fas fa-file-pdf text-danger"></i> Production Summary</strong>
                        <small class="text-muted">2h ago</small>
                    </div>
                    <small class="text-muted">Nov 23, 2025</small>
                </div>
                <div class="recent-report">
                    <div class="d-flex justify-content-between">
                        <strong><i class="fas fa-file-excel text-success"></i> Stock Levels</strong>
                        <small class="text-muted">5h ago</small>
                    </div>
                    <small class="text-muted">Nov 23, 2025</small>
                </div>
                <div class="recent-report">
                    <div class="d-flex justify-content-between">
                        <strong><i class="fas fa-file-pdf text-danger"></i> Quality Metrics</strong>
                        <small class="text-muted">Yesterday</small>
                    </div>
                    <small class="text-muted">Nov 22, 2025</small>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Custom Report Builder Modal -->
<div class="modal fade" id="customReportModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><i class="fas fa-magic"></i> Custom Report Builder</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="mb-3">
                    <label class="form-label"><strong>Report Name</strong></label>
                    <input type="text" class="form-control" placeholder="Enter report name...">
                </div>
                <div class="mb-3">
                    <label class="form-label"><strong>Data Source</strong></label>
                    <select class="form-select">
                        <option>Production Jobs</option>
                        <option>Inventory Items</option>
                        <option>Quality Inspections</option>
                        <option>Employees</option>
                        <option>Work Orders</option>
                        <option>Sales Orders</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label"><strong>Fields to Include</strong></label>
                    <select class="form-select" multiple size="6">
                        <option>ID</option>
                        <option>Name</option>
                        <option>Status</option>
                        <option>Created Date</option>
                        <option>Modified Date</option>
                        <option>Assigned To</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="form-label"><strong>Date Range</strong></label>
                    <div class="row">
                        <div class="col-6">
                            <input type="date" class="form-control" placeholder="From">
                        </div>
                        <div class="col-6">
                            <input type="date" class="form-control" placeholder="To">
                        </div>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="form-label"><strong>Format</strong></label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="format" id="formatExcel" checked>
                        <label class="form-check-label" for="formatExcel">Excel (.xlsx)</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="format" id="formatPDF">
                        <label class="form-check-label" for="formatPDF">PDF</label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="format" id="formatCSV">
                        <label class="form-check-label" for="formatCSV">CSV</label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" onclick="generateCustomReport()">
                    <i class="fas fa-magic"></i> Generate Report
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
function filterCategory(category) {
    // Update active button
    document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.remove('active');
    });
    event.target.classList.add('active');

    // Filter reports
    if (category === 'all') {
        document.querySelectorAll('[data-category]').forEach(el => {
            el.style.display = '';
        });
    } else {
        document.querySelectorAll('[data-category]').forEach(el => {
            if (el.dataset.category === category) {
                el.style.display = '';
            } else {
                el.style.display = 'none';
            }
        });
    }
}

function generateReport(reportId) {
    alert('Generating report: ' + reportId);
    // In real implementation, this would trigger report generation
}

function generateCustomReport() {
    alert('Generating custom report...');
    bootstrap.Modal.getInstance(document.getElementById('customReportModal')).hide();
}
</script>
{% endblock %}
